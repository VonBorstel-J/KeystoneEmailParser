# config\parser_config.yaml

# Directory where models will be cached
cache_dir: ".cache"

# Authentication settings
authentication:
  hf_token_env_var: "HF_TOKEN"  # Environment variable name for Hugging Face token

data_points:
  Requesting_Party:
    description: "Information about the requesting party."
    Insurance_Company:
      description: "Name of the insurance company."
    Handler:
      description: "Handler's name and contact information."
    Carrier_Claim_Number:
      description: "Unique claim number assigned by the carrier."
  Insured_Information:
    Name:
      description: "Full name of the insured individual."
    Contact_Number:
      description: "Contact number of the insured."
    Loss_Address:
      description: "Address where the loss occurred."
    Public_Adjuster:
      description: "Information about the public adjuster, if any."
    Ownership_Status:
      description: "Whether the insured is an owner or tenant of the loss location."
  Adjuster_Information:
    Adjuster_Name:
      description: "Name of the adjuster."
    Adjuster_Phone_Number:
      description: "Phone number of the adjuster."
    Adjuster_Email:
      description: "Email address of the adjuster."
    Job_Title:
      description: "Job title of the adjuster."
    Address:
      description: "Address of the adjuster."
    Policy_Number:
      description: "Policy number associated with the claim."
  Assignment_Information:
    Date_of_Loss:
      description: "Date when the loss or occurrence happened."
    Cause_of_Loss:
      description: "Cause behind the loss."
    Facts_of_Loss:
      description: "Detailed facts surrounding the loss."
    Loss_Description:
      description: "Description of the loss."
    Residence_Occupied:
      description: "Whether the residence was occupied during the loss."
    Someone_Home:
      description: "Whether someone was home at the time of damage."
    Repair_Progress:
      description: "Progress on repair or mitigation."
    Type:
      description: "Type of loss or claim."
    Inspection_Type:
      description: "Type of inspection conducted."
  Assignment_Type:
    Wind:
      description: "Wind-related damage."
    Structural:
      description: "Structural damage."
    Hail:
      description: "Hail-related damage."
    Foundation:
      description: "Foundation-related damage."
    Other:
      description: "Other types of damage. Provide details if selected."
  Additional_Details:
    description: "Any additional details or special instructions."
  Attachments:
    description: "List of attachments related to the email."

# Model Configurations
models:
  # Document parsing model
  donut:
    repo_id: "naver-clova-ix/donut-base-finetuned-cord-v2"
    task: "document"
    processor: "naver-clova-ix/donut-base-finetuned-cord-v2"
    model: "naver-clova-ix/donut-base-finetuned-cord-v2"
    device: "auto"
    timeout: 60
    max_length: 1024
    quantize: true

  # LLaMA for text-based parsing, replacing NER functionality
  model_based_parsing:
    repo_id: "meta-llama/Llama-3.2-3B-Instruct"
    task: "text2text-generation"
    timeout: 45
    max_length: 1024
    quantize: true
    device: "auto"

  # Validation using LLaMA
  validation:
    repo_id: "meta-llama/Llama-3.2-3B-Instruct"
    task: "text2text-generation"
    timeout: 30
    max_length: 512
    quantize: true
    device: "auto"

  # Summarization using LLaMA
  summarization:
    repo_id: "meta-llama/Llama-3.2-3B-Instruct"
    task: "summarization"
    timeout: 45
    max_length: 768
    quantize: true
    device: "auto"
    parameters:
      max_chunk_size: 1000
      min_summary_length: 50
      max_summary_length: 150
      stride: 100
      temperature: 0.7
      top_p: 0.9
      max_retries: 3
      preprocessing:
        remove_signatures: true
        clean_headers: true
        normalize_whitespace: true


# Processing Configuration
processing:
  batch_size: 2                      # Increased batch size for efficiency
  max_length: 1024                   # Increased token length to accommodate larger inputs
  device: "auto"                    # Device selection ('auto', 'cuda', 'cpu')
  fallback_to_cpu: true              # Whether to fallback to CPU if GPU not available

# Additional Configurations
fuzzy_threshold: 90                 # Threshold for fuzzy matching (adjust as needed)

# Known values for NER model to match (Claim numbers, insurance companies, etc.)
known_values:
  Claim Number:
    - "ABC123"
    - "XYZ789"
  Insurance Company:
    - "State Farm"
    - "Geico"
  # Add more known fields as needed...

date_formats:
  - '%m/%d/%Y'
  - '%Y-%m-%d'
  # Add more formats as needed...

boolean_values:
  positive:
    - 'yes'
    - 'true'
    - '1'
  negative:
    - 'no'
    - 'false'
    - '0'

valid_extensions:
  - '.pdf'
  - '.docx'
  - '.png'
  - '.jpg'
  - '.csv'

# Performance Enhancements
enable_amp: true  # Automatic Mixed Precision to improve GPU utilization and speed
optimize_memory: true  # Optimize memory usage to handle larger documents without performance degradation

# Logging Configuration
logging:
  level: "DEBUG"  # Set logging level to DEBUG for detailed output
  handlers:
    - "StreamHandler"
    - "FileHandler"
  file_path: "logs/parser.log"  # File path for log output
  create_logs_dir_if_not_exists: true  # Create logs directory if it does not exist
